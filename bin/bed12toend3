cat $1 | awk -v len=$2 '{OFS="\t";split($11,blockSizes,",");split($12,blockStarts,",");blockCount=$10;A=""; B="";if($6=="+"){S=0;txStart=$2;for(i=blockCount;i>=1;--i){S+=blockSizes[i];if(S<len){A=blockSizes[i]","A;B=blockStarts[i]","B;}else{A=blockSizes[i]-(S-len)","A;B=blockStarts[i]+(S-len)","B;newBlockCount=split(B,newBlockStarts,",")-1;B2="";for(j=newBlockCount;j>=1;--j) B2=newBlockStarts[j]-newBlockStarts[1]","B2;print $1,$2+newBlockStarts[1],$3,$4,$5,$6,$2+newBlockStarts[1],$3,0,newBlockCount,A,B2;break;}}}else{S=0;txStart=$3;for(i=1;i<=blockCount;++i){S+=blockSizes[i];if(S<len){A=A blockSizes[i]",";B=B blockStarts[i]",";}else{A=A blockSizes[i]-(S-len)",";B=B blockStarts[i]",";newBlockCount=split(B,newBlockStarts,",")-1;split(A,newBlockSizes,",");print $1,$2,$2+newBlockStarts[newBlockCount]+newBlockSizes[newBlockCount],$4,$5,$6,$2,$2+newBlockStarts[newBlockCount]+newBlockSizes[newBlockCount],0,newBlockCount,A,B;break;}}}}'
